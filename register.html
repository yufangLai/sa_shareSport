<!DOCTYPE html>
<html>

<head>
	 <meta name="viewport" content="width=device-width, initial-scale=1.0">
     <meta http-equiv="X-UA-Compatible" content="ie=edge">
     <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous">
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
        integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous">
    </script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
        integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous">
    </script>
    <link rel="stylesheet" href="brow_courses.css">
     
    
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>shareSport - 註冊</title>
    <link href="statics/icon/favicon.ico" type="image/x-icon" rel="icon">
    <link href="statics/icon/favicon.ico" type="image/x-icon" rel="shortcut icon">
    <link rel="stylesheet" type="text/css" href="statics/css/cake.generic.css">

    <script src="statics/js/jquery-3.4.1.min.js" crossorigin="anonymous"></script>
</head>

<body>

	<nav class="nav" style="background-color: #e3f2fd;">
 	 <a class="navbar-brand" href="#">shareSport</a>
    <ul class="nav justify-content-end">
    <li class="nav-item">
     <a class="nav-link active" href="#">首頁</a>
   </li>
   <li class="nav-item">
     <a class="nav-link active" href="#">瀏覽教練</a>
   </li>
   <li class="nav-item">
     <a class="nav-link active" href="#">瀏覽教程</a>
   </li>
   <li class="nav-item">
     <a class="nav-link active" href="#">個人專區</a>
   </li>
   <li class="nav-item">
     <a class="nav-link active" href="#">管理介面</a>
   </li>
   <li class="nav-item">
     <a class="nav-link active" id="sign" href="#">登入</a>
   </li>
   <li class="nav-item">
     <a class="nav-link active" id="regsign" href="#">註冊</a>
   </li>
   </ul>
	</nav>

    <div id="container">
        
        <div id="content">
            <h1>註冊</h1>
            <h5 class="star">*為必填</h5><br>
			
			<div id="image">    
			<img width="85%" length="85%" alt="圖片失效" src="http://www.instyle.tw/uploads/tiny_mce/images/%E5%B0%88%E7%82%BA%E5%A5%B3%E6%80%A7%E7%B6%9C%E5%90%88%E8%A8%93%E7%B7%B4%E6%89%93%E9%80%A0%E7%9A%84%E3%80%8CUA%20Vanish%E3%80%8D%E7%B3%BB%E5%88%97%E5%AE%8C%E7%BE%8E%E5%B1%95%E7%8F%BE%E5%A5%B3%E6%80%A7%E5%9C%A8%E9%81%8B%E5%8B%95%E6%99%82%E7%9A%84%E6%80%A7%E6%84%9F%E8%88%87%E8%87%AA%E4%BF%A1%E3%80%82.jpg">
			</div>
            
            <div id="flashMessage" class="message" style="display: none;"></div>

            <form id="form" accept-charset="utf-8">
            
                <div style="display:none;"><input type="hidden" name="_method" value="POST"></div>
               
               
               <div class="input select required">
					<label for="member_identity">身分</label><label class="star">*</label><br>
					<select name="identity" id="member_identity" required="required">
					<option value="default">選擇身分</option>
					<option value="student">學生</option>
					<option value="coach">教練</option>
					</select>
               </div><br>
               
                <div class="input text required">
                    <label for="member_name">姓名</label><label class="star">*</label><br>
                    <input name="name" maxlength="45" type="text" id="member_name" required="required">
                </div><br>
              
              <div class="input select required">
					<label for="member_sex">性別</label><label class="star">*</label><br>
					<select name="sex" id="member_sex" required="required">
					<option value="default">選擇性別</option>
					<option value="male">男</option>
					<option value="female">女</option>
					</select>
               </div><br>
               
                <div class="input email required">
                    <label for="member_email">電子信箱</label><label class="star">*</label><br>
                    <input name="email" maxlength="45" type="email" id="member_email" required="required">
                </div><br>
              
                <div class="input password required">
                    <label for="member_password">密碼</label><label class="star">*</label><br>
                    <input name="password" maxlength="45" type="password" id="member_password" required="required">
                </div><br>
                    
                <div class="input password required">
                    <label for="confirm_password">確認密碼</label><label class="star">*</label><br>
                    <input name="con_password" maxlength="45" type="password" id="confirm_password" required="required">
                </div><br>

                <div class="submit"><input type="button" value="註冊" id="submit" class="btn btn-primary"></div>
            </form>
            
            
                </div>
            
           <script type="text/javascript">
            
            var i = 0;//控制登入登出
            $("#sign").click(function () {
                if (i == 0) {
                    document.getElementById("sign").innerHTML = "登出";
                    i = 1;
                    document.getElementById("regsign").style.display="none";
                } else {
                    document.getElementById("sign").innerHTML = "登入";
                    i = 0;
                    document.getElementById("regsign").style.display="block";
                }
            });
            
               $(document).ready(function() {
                    // 處理表單點擊事件
                    var $form = $('#submit');
                    $form.click(function() {
                        submit();
                    });

                    function submit() {
                    	var identity = $('#member_identity').val();
                        var name = $('#member_name').val();
                        var sex = $('#member_sex').val();
                        var email = $('#member_email').val();
                        var password = $('#member_password').val();
                        var con_password = $('#confirm_password').val();
                        

                        var email_rule = /^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z]+$/;
                        var password_rule = /^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d]{8,}$/;
                        
                        if(identity=="default"){
                       		alert("請選擇身分！");
                        }
                        
                        else if(!name){
                        	alert("請輸入姓名！");
                        }
                        
                        else if(sex=="default"){
                       		alert("請選擇性別！");
                        }
                        
                        else if(!email_rule.test(email)) {
                            alert("Email格式不符！");
                        }
                        
                        else if(!password_rule.test(password)) {
                            alert("密碼格式不符！\n密碼長度至少需為8，並包含至少一個數字和英文字母。\n同時不可包含特殊符號！");
                        }
                 
                       else if(con_password!=password){
                    	    alert("確認密碼與密碼不符！");
                       }
                        
                        
                        else {
                        	  
                            // 將資料組成JSON格式
                            var data_object = {
                                "identity" : identity,
                            	"name": name,
                                "sex" : sex,
                            	"email": email,
                                "password": password
                            };

                            // 將JSON格式轉換成字串
                            var data_string = JSON.stringify(data_object);
                            


                            // 發出POST的AJAX請求
                            var options = {
                            	 type: "POST",
                                 url: "/api/student.do",
                                 data: data_string,
                                 crossDomain: true,
                                 cache: false,
                                 dataType: 'json',
                                 timeout: 5000,
                                 
                                 success: function (response) {
                                     $('#flashMessage').html(response.message);
                                     $('#flashMessage').show();
                                     if(response.status == 200){
                                         updateSQLTable(response.response);
                                     }
                                 },
                                 
                                 error: function () {
                                     alert("無法連線到伺服器！");
                                     
                                 }
                            }
                            
                            if (identity === "coach") {options.url = "/api/coach.do";}
                            $.ajax(options);
                      
                            alert("註冊成功！\n正在為您導回首頁！");
                        }
                    }
                });
            </script>

    </div>
    
    
   <style type="text/css">
* {
    box-sizing: border-box;
}

#submit {
    margin-left: 80px;
}

#image {
	position: absolute; 
	top: 200px;
	right: -50px;
}

#content {
    margin-left: 120px;
    margin-right: 340px;
}


html,
body {
    margin-top: 2px;
    margin-bottom: 2px;
    margin-left: 27px;
    margin-right: 27px;

    padding: 0px;
}

.nav {
    font-size: 20px;
    margin-bottom: 25px;
}


#coach-name {
    font-size: 25px;
    color: rgb(53, 121, 247)
}

.star {
	color: red;
}

</style>
</body>

</html>