<!DOCTYPE html>
<html >
<head>
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
<script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
<meta charset="BIG5">
<title>學生個人專區</title>
<style>
.manageclass {
  visibility: hidden;
}
.managecoach {
  visibility: hidden;
}
.deleteclass {
  visibility: hidden;
}
.deletecoach {
  visibility: hidden;
}
h2{
display: inline-block;
}
.course{
	width:13rem;
	display: inline-block;
	margin-bottom:33px;
	margin-left:55px;
}
{
    box-sizing: border-box;
}

html,
body {
    margin-top: 2px;
    margin-bottom: 2px;
    margin-left: 27px;
    margin-right: 27px;
    padding: 0px;
}
.nav {
    font-size: 20px;
    margin-bottom: 25px;
}
</style>
</head>
<body>
<nav class="nav" style="background-color: #e3f2fd;">
  <a class="navbar-brand" href="#">shareSport</a>
    <ul class="nav justify-content-end">
    <li class="nav-item">
    	<a class="nav-link active" href="#">首頁</a>
  	</li>
  	<li class="nav-item">
    	<a class="nav-link active" href="#">瀏覽教練</a>
  	</li>
  	<li class="nav-item">
    	<a class="nav-link active" href="#">瀏覽教練</a>
  	</li>
  	<li class="nav-item">
    	<a class="nav-link active" href="#">個人專區</a>
  	</li>
  	<li class="nav-item">
    	<a class="nav-link active" href="#">管理介面</a>
  	</li>
  	<li class="nav-item">
    	<a class="nav-link active" id="sign" href="#">登入</a>
  	</li>
  	<li class="nav-item">
    	<a class="nav-link active" href="#">註冊</a>
  	</li>
   </ul>
  
</nav>
	<div class="card mb-3" style="max-width: 540px;">
	  <div class="row no-gutters">
	    <div class="col-md-4">
	      <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn%3AANd9GcTxDQcl1SA2jzxtsOqnl0eA-zF9p0JoDFZCALHVI25lqAdzR-Ec" class="card-img" alt="...">
	    </div>
	    <div class="col-md-8">
	      <div class="card-body">
	        <h2 id=studentname class="card-title">學生名稱</h2>
	        <p class="card-text"><small class="text-muted">Last updated 3 mins ago</small></p>
	  		<button id=modifyself type="button" class="btn btn-outline-primary">修改個人資料</button>
	      </div>
	    </div>
	  </div>
	</div>
	
	<h2>我的教程</h2>
		<button id ="modifyclass" type="button" class="btn btn-outline-primary">管理教程</button>
		<button type="button" class="btn btn-outline-primary manageclass">儲存</button><br>
		
			<div class="card course">
	  			<a href="該教程網址">
	    		<img src="https://encrypted-tbn0.gstatic.com/images?q=tbn%3AANd9GcTxDQcl1SA2jzxtsOqnl0eA-zF9p0JoDFZCALHVI25lqAdzR-Ec" class="card-img-top" alt="..." width="13rem" height="160rem">
	    		</a>
	    		<div class="card-body">
	      			<h5 class="card-title">教程名稱</h5>
	      			<p class="card-text">教程簡介</p>
		        	<a href="#"  class="btn btn-primary deleteclass" >刪除教程</a>
	    		</div>
	  		</div>
	  		
	  		
		
			
	<h2>我的教練</h2>
		<button id="modifycoach" type="button" class="btn btn-outline-primary">管理教練</button>
		<button type="button" class="btn btn-outline-primary managecoach">儲存</button><br>
		
			<div class="card course">
	  			<a href="該教練網址">
	    		<img src="https://encrypted-tbn0.gstatic.com/images?q=tbn%3AANd9GcTxDQcl1SA2jzxtsOqnl0eA-zF9p0JoDFZCALHVI25lqAdzR-Ec" class="card-img-top" alt="..." width="13rem" height="160rem">
	    		</a>
	    		<div class="card-body">
	      			<h5 class="card-title">教練名稱</h5>
		        	<a href="#" class="btn btn-primary deletecoach">刪除教練</a>
	    		</div>
	  		</div>
	  		<div class="card course">
	  			<a href="該教練網址">
	    		<img src="https://encrypted-tbn0.gstatic.com/images?q=tbn%3AANd9GcTxDQcl1SA2jzxtsOqnl0eA-zF9p0JoDFZCALHVI25lqAdzR-Ec" class="card-img-top" alt="..." width="13rem" height="160rem">
	    		</a>
	    		<div class="card-body">
	      			<h5 class="card-title">教練名稱</h5>
		        	<a href="#" class="btn btn-primary deletecoach">刪除教練</a>
	    		</div>
	  		</div>
	  		<div class="card course">
	  			<a href="該教練網址">
	    		<img src="https://encrypted-tbn0.gstatic.com/images?q=tbn%3AANd9GcTxDQcl1SA2jzxtsOqnl0eA-zF9p0JoDFZCALHVI25lqAdzR-Ec" class="card-img-top" alt="..." width="13rem" height="160rem">
	    		</a>
	    		<div class="card-body">
	      			<h5 class="card-title">教練名稱</h5>
		        	<a href="#" class="btn btn-primary deletecoach">刪除教練</a>
	    		</div>
	  		</div>
		
	<script>
	$("#modifyself").click(function () {
		//要導入修改網址
	});
	    $("#modifyclass").click(function () {//管理教程功能
			$(".manageclass").css("visibility","visible");
			$(".deleteclass").css("visibility","visible");
		});
	    
	    $(".manageclass").click(function () {//教程儲存
			$(".manageclass").css("visibility","hidden");
			$(".deleteclass").css("visibility","hidden");
		});
	    $("#modifycoach").click(function () {//管理教練
			$(".managecoach").css("visibility","visible");
			$(".deletecoach").css("visibility","visible");
		});
	    $(".managecoach").click(function () {//教練儲存
			$(".managecoach").css("visibility","hidden");
			$(".deletecoach").css("visibility","hidden");
		});
		var i = 0;//控制登入登出
        $("#sign").click(function () {
            if (i == 0) {
                document.getElementById("sign").innerHTML = "登出";
                i = 1;
            } else {
                document.getElementById("sign").innerHTML = "登入";
                i = 0;
            }
        });
		
        function deleteMember(id) {
            var check = window.confirm("確認刪除教程？");
            if (check == true) {
                console.log("You pressed OK!");
                var request = {'id': id};
                var data_string = JSON.stringify(request);
                $.ajax({
                    type: "DELETE",
                    url: "api/member.do",
                    crossDomain: true,
                    data: data_string,
                    cache: false,
                    dataType: 'json',
                    timeout: 5000,
                    success: function (response) {
                        if(response.status == 200){
                        	alert('刪除成功');
                 
                            getAllMember();
                        }
                        console.log(response);
                    },
                    error: function () {
                        alert("無法連線到伺服器！");
                    }
                });
            }
            else {
                console.log("You pressed Cancel!");
            }
        }

        function getAllMember() {  //
            // 發出POST的GET請求取得所有會員列表  推資料去伺服器
            $.ajax({  //http的呼叫
                    type: "GET",
                    url: "api/member.do",    //
                    crossDomain: true,
                    cache: false,
                    dataType: 'json',
                    timeout: 5000,
                    success: function (response) {  //假如成功  server回傳會丟到responce裡
                        if(response.status == 200){
                            updateTable(response.response.data);
                            updateSQLTable(response.response);
                        }
                        console.log(response);
                    },
                    error: function () {
                        alert("無法連線到伺服器！");
                    }
            });
        }
        
        // 更新會員列表表格
        function updateTable(data) {
            $("#table > tbody").empty();
            var table_html = '';
            $.each(data, function(index, value) {//撈資料
                table_html += '<tr><td scope="row">' + value['id'] + '</td>';
                table_html += '<td>' + value['name'] + '</td>';
                table_html += '<td>' + value['email'] + '</td>';
                table_html += '<td>' + value['login_times'] + '</td>';
                table_html += '<td>' + value['status'] + '</td>';
                table_html += '<td>' + '<a href="edit.html?id=' + value['id'] + '">編輯</a> | ';//動態產生  連接網址(VALUE['ID'])  兩個編輯按進去的網址不一樣
                table_html += '<a href="javascript: deleteMember(' + value['id'] + ');">刪除</a></td></tr>';//當場刪資料  呼叫JS裡的DELETEMEMBER方法  先去資料庫刪掉在撈一次資料
            })

            $("#table > tbody").append(table_html);
            
            let inner_html = '';
        	inner_html += '<div class="col-md-4">';
       		inner_html += '<div class="card-header">';
       		inner_html += '<h4 class="font-weight-normal text-center text-truncate">' + data.name + '</h4>';
     		inner_html += '</div>';
     		inner_html += '<div class="card mb-4 shadow-sm">';
     		inner_html += '<img src="statics/img/product/' + data.image + '" width="100%">';
    		inner_html += '<div class="card-body">';
    		inner_html += '<h1 class="card-title pricing-card-title">$' + data.price + ' <small class="text-muted">/ USD</small></h1>';
    		inner_html += '<p class="card-text">' + data.describe + '</p>';
    		inner_html += '<div class="d-flex justify-content-between align-items-center">';
    		inner_html += '<div class="btn-group">';
    		inner_html += '<button id="add_cart_' + data.id + '" name="add_cart" type="button" class="btn btn-lg btn-block btn-outline-primary">加入購物車</button>';
    		inner_html += '</div><small class="text-muted">id: ' + data.id + '</small>';
    		inner_html += '</div></div></div></div>';
        	
    		return inner_html;
        }
        
        // 更新SQL指令歷史表格
        function updateSQLTable(data) {
            $("#sql_log > tbody").empty();
            var time = (data.time / 1000000).toFixed(2);
            var table_html = "";
            
            sql_num = 0;
            sql_num += 1

            table_html += '<tr>';
            table_html += '<td>' + sql_num + '</td>';
            table_html += '<td>' + data.sql + '</td>';
            table_html += '<td style="text-align: right">' + '0' + '</td>';
            table_html += '<td style="text-align: right">' + data.row + '</td>';
            table_html += '<td style="text-align: right">' + data.row + '</td>';
            table_html += '<td style="text-align: right">' + time + '</td>';
            table_html += '</tr>';
            $("#sql_log > tbody").append(table_html);
            $("#sql_summary").html("(default) " + data.row + " queries took " + time + " ms");
        }
        $(document).ready(function() {
            getAllMember();
        });
	</script>
</body>
</html>